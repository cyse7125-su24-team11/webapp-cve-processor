# Start from the Flyway base image
FROM flyway/flyway:latest

ARG username
ENV db_username=$username

ARG password
ENV db_password=$password

# Copy the migration scripts and configuration
COPY ./db/sql /flyway/sql
COPY ./db/flyway.conf /flyway/conf/flyway.conf

# Entry point to allow running Flyway commands
ENTRYPOINT ["flyway"]

CMD ["-url=jdbc:postgresql://host.docker.internal:5432/cve", "migrate"]
